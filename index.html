<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ARCHANGEL // Tactical Operations Suite v5.1</title>
    <style>
        :root {
            --bg: #0a0c10; --panel: #11151c; --border: #232a35;
            --text: #c9d1d9; --muted: #6e7681; --accent: #3b82f6;
            --danger: #ef4444; --success: #22c55e;
        }

        * { box-sizing: border-box; scrollbar-width: none; }
        body { 
            margin: 0; background: var(--bg); color: var(--text); 
            font-family: 'JetBrains Mono', 'Consolas', monospace; 
            height: 100vh; display: grid; grid-template-columns: 320px 1fr;
        }

        /* SIDEBAR Glass Effect */
        #sidebar { 
            background: var(--panel); border-right: 1px solid var(--border); 
            padding: 25px; display: flex; flex-direction: column; gap: 20px; 
            box-shadow: 10px 0 30px rgba(0,0,0,0.5);
        }

        .module { 
            border: 1px solid var(--border); padding: 15px; background: #0d1117; 
            border-radius: 4px; position: relative; overflow: hidden;
        }

        .label { font-size: 10px; color: var(--muted); text-transform: uppercase; letter-spacing: 1.5px; }
        .metric { font-size: 16px; margin-top: 8px; font-weight: bold; color: #fff; }

        .progress { height: 4px; background: #1a212a; margin-top: 10px; border-radius: 2px; overflow: hidden; }
        .progress div { height: 100%; background: var(--accent); width: 0%; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); }

        /* MAIN WORKSPACE */
        #main { display: grid; grid-template-rows: 45px 1fr 220px; }
        #topbar { 
            background: var(--panel); border-bottom: 1px solid var(--border); 
            display: flex; align-items: center; padding: 0 25px; font-size: 11px; 
            justify-content: space-between; letter-spacing: 1px;
        }

        #console { 
            padding: 30px; overflow-y: auto; background: #05070a; 
            display: flex; flex-direction: column; gap: 4px;
        }

        .line { font-size: 14px; line-height: 1.6; animation: fadeIn 0.2s ease-in; }
        .prompt { color: var(--accent); font-weight: bold; margin-right: 10px; }
        
        #cmdInput { 
            background: none; border: none; outline: none; color: #fff; 
            font-family: inherit; font-size: 14px; width: 80%;
        }

        #bottom { display: grid; grid-template-columns: 1fr 400px; border-top: 1px solid var(--border); background: #080b10; }
        #memory, #packets { padding: 15px; font-size: 11px; font-family: monospace; line-height: 1.4; color: #4e5660; }
        #packets { color: var(--success); border-left: 1px solid var(--border); }

        @keyframes fadeIn { from { opacity: 0; transform: translateX(-5px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>

<div id="sidebar">
    <div style="padding-bottom: 20px; border-bottom: 1px solid var(--border);">
        <h3 style="margin:0; letter-spacing: 2px;">ARCHANGEL <span style="color:var(--accent)">v5.1</span></h3>
        <div style="font-size: 10px; color: var(--muted); margin-top: 5px;">TACTICAL OPERATIONS SUITE</div>
    </div>

    <div class="module">
        <div class="label">Primary Node</div>
        <div class="metric" id="ip" style="font-size: 13px; color: var(--accent);">Resolving...</div>
    </div>

    <div class="module">
        <div class="label">Neural Core Load</div>
        <div class="progress"><div id="cpuBar"></div></div>
        <div class="metric" id="cpuText">0%</div>
    </div>

    <div class="module">
        <div class="label">Memory Buffer</div>
        <div class="progress"><div id="ramBar" style="background:var(--success)"></div></div>
        <div class="metric" id="ramText">0%</div>
    </div>
</div>

<div id="main">
    <div id="topbar">
        <div><span style="color:var(--muted)">OPERATOR:</span> PRODIGY_40</div>
        <div style="color:var(--danger)"><span class="blink">‚óè</span> ENCRYPTED SESSION ACTIVE</div>
    </div>

    <div id="console"></div>

    <div id="bottom">
        <div id="memory"></div>
        <div id="packets"></div>
    </div>
</div>

<script>
const consoleEl = document.getElementById("console");
const memoryEl = document.getElementById("memory");
const packetEl = document.getElementById("packets");

// NEW: Smooth Async Printer
async function print(text, delay = 20) {
    const div = document.createElement("div");
    div.className = "line";
    consoleEl.appendChild(div);
    
    for (let char of text) {
        div.innerHTML += char;
        await new Promise(r => setTimeout(r, delay));
        consoleEl.scrollTop = consoleEl.scrollHeight;
    }
}

function prompt() {
    const line = document.createElement("div");
    line.className = "line";
    line.innerHTML = `<span class="prompt">ARCHANGEL></span><input id="cmdInput" spellcheck="false" autocomplete="off" />`;
    consoleEl.appendChild(line);
    
    const input = document.getElementById("cmdInput");
    input.focus();

    input.addEventListener("keydown", async function(e) {
        if (e.key === "Enter") {
            const val = input.value;
            line.innerHTML = `<span class="prompt">ARCHANGEL></span> ${val}`;
            await processCommand(val.trim().toLowerCase());
            prompt();
        }
    });
}

async function processCommand(cmd) {
    if (!cmd) return;
    
    switch(cmd) {
        case "help":
            await print("> Available modules: scan, trace, decrypt, clear, status");
            break;
        case "scan":
            await print("[*] Initiating deep-layer heuristic scan...");
            await new Promise(r => setTimeout(r, 800));
            await print("[+] Result: All systems nominal. 40/40 integrity.");
            break;
        case "decrypt":
            await print("[!] Initializing brute-force on remote buffer...");
            await print("[####------] 40% Complete...");
            await new Promise(r => setTimeout(r, 1000));
            await print("[SUCCESS] Partition mounted at /mnt/vault");
            break;
        case "clear":
            consoleEl.innerHTML = "";
            break;
        default:
            await print(`[-] Error: Command '${cmd}' not recognized in this kernel.`);
    }
}

// Stats Generation (Faster & More Dynamic)
function updateStats() {
    const cpu = Math.floor(Math.random() * 15) + 30; // Realer jitter
    const ram = Math.floor(Math.random() * 5) + 60;

    document.getElementById("cpuBar").style.width = cpu + "%";
    document.getElementById("cpuText").innerText = cpu + "%";
    document.getElementById("ramBar").style.width = ram + "%";
    document.getElementById("ramText").innerText = ram + "%";

    // Memory Stream
    let hex = "0x" + Math.floor(Math.random() * 0xFFFFFFFF).toString(16).toUpperCase().padStart(8, '0') + " ";
    for(let i=0; i<6; i++) hex += Math.floor(Math.random()*256).toString(16).padStart(2,"0") + " ";
    memoryEl.innerHTML = hex + "<br>" + memoryEl.innerHTML.slice(0, 500);

    // Packet Stream
    const p = `INBOUND [${Math.floor(Math.random()*65535)}] -> 192.168.1.40 [TLS1.3]`;
    packetEl.innerHTML = p + "<br>" + packetEl.innerHTML.slice(0, 500);
}

setInterval(updateStats, 800);

fetch("https://ipapi.co/json/")
    .then(r => r.json())
    .then(d => { document.getElementById("ip").innerText = d.ip + " // " + d.city.toUpperCase(); })
    .catch(() => { document.getElementById("ip").innerText = "LOCAL_NODE // 127.0.0.1"; });

print("ARCHANGEL CORE v5.1 SECURE LINK ESTABLISHED...", 10).then(prompt);
</script>
</body>
</html>
